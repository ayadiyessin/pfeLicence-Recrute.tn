<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Gestionnaire | Profile Demandeur D'emploi Archivé</title>
  <link rel="icon" type="image/png" href="../dist/img/Recrutelogo.png">
  <link href="../dist/css/styessin.css" rel="stylesheet">
  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="../plugins/fontawesome-free/css/all.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../dist/css/adminlte.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="../plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="../plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <link rel="stylesheet" href="../plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
  <script>
    if(!localStorage.getItem("ID_ADM")){
      location.replace("login.html");
    }
  </script>
  <script language="JavaScript">
    function darkmode() {
  document.body.classList.add("dark-mode");
    }
    function nodark() {
  document.body.classList.remove("dark-mode");
    }
 function mode(){
  if (document.getElementById("demo5").checked) {
    darkmode(); //if the checkbox is checked, run this funtion
  } else {
    nodark(); //else run this funtion
  }
 }
  </script>
  
</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">
  <!-- Preloader -->
  <div class="preloader flex-column justify-content-center align-items-center">
    <img class="animation__shake" src="../dist/img/Recrute.fr.png" alt="AdminLTELogo" >
  </div>

  <!-- Navbar -->
  <nav class="main-header navbar navbar-expand navbar-white navbar-light">
    <!-- Left navbar links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
      </li>
      <li class="nav-item d-none d-sm-inline-block">
        <a href="../index.html" class="nav-link">Accueil</a>
      </li>
    </ul>

    <!-- Right navbar links -->
    <ul class="navbar-nav ml-auto">
      <!-- Notifications Dropdown Menu -->
      <li class="nav-item dropdown">
        <a class="nav-link" data-toggle="dropdown" href="#">
          <i class="far fa-bell"></i>
          <span id="nbtotalhaut" class="badge badge-warning navbar-badge"></span>
        </a>
        <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
          <span class="dropdown-item dropdown-header"><span id="nbtotalmenu"></span> &ensp; Notifications</span> 
          <div class="dropdown-divider"></div>
          <a href="reclamation.html" class="dropdown-item">
            <i class="fas fa-copy mr-2"></i><span id="nbrecla"></span> &ensp;new réclamations
          </a>
          <div class="dropdown-divider"></div>
          <a href="contacts.html" class="dropdown-item">
            <i class="fas fa-comments mr-2"></i> <span id="nbrecontact"></span>&ensp;new contacts
          </a>
          <div class="dropdown-divider"></div>
          <a href="recruteurEnAttente.html" class="dropdown-item">
            <i class="fas fa-building mr-2"></i> <span id="nbrecrutEA"></span>&ensp;récruteur en attente
          </a>
          <div class="dropdown-divider"></div>
          <!--<div class="dropdown-divider"></div>
          <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
        </div>-->
      </li>
      <li class="nav-item">
        <a class="nav-link" data-widget="fullscreen" href="#" role="button">
          <i class="fas fa-expand-arrows-alt"></i>
        </a>
      </li>
      <li class="nav-item">
        <!-- mta dark-->
        <input  type="checkbox" class="demo5 " onclick="mode()" id="demo5">
        <label for="demo5"></label>
    </li>
    </ul>
  </nav>
  <!-- /.navbar -->
 <!-- Main Sidebar Container -->
 <aside class="main-sidebar sidebar-dark-primary elevation-4">
  <!-- Brand Logo -->
  <a href="../index.html" class="brand-link">
    <img src="../dist/img/Recrutelogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
    <span class="brand-text font-weight-light">Recrute.tn</span>
  </a>

  <!-- Sidebar -->
  <div class="sidebar">
    <!-- Sidebar user panel (optional) -->
    <div class="user-panel mt-3 pb-3 mb-3 d-flex">
      <div class="image">
        <img src="" id="nvphoto" style="width:32px; height: 32px;" class="img-circle elevation-2" alt="User Image">
      </div>
      <div class="info">
        <a href="profileAdmin.html" class="d-block"id="nvprof"></a>
      </div>
    
    </div>

    <!-- SidebarSearch Form -->
    <div class="form-inline">
      <div class="input-group" data-widget="sidebar-search">
        <input class="form-control form-control-sidebar" type="search" placeholder="Search" aria-label="Search">
        <div class="input-group-append">
          <button class="btn btn-sidebar">
            <i class="fas fa-search fa-fw"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Sidebar Menu -->
    <nav class="mt-2">
      <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
        <!-- Add icons to the links using the .nav-icon class
             with font-awesome or any other icon font library -->
        <li class="nav-item ">
          <a href="../index.html" class="nav-link">
            <i class="nav-icon fas fa-tachometer-alt"></i>
            <p>
             Tableau De Bord
            </p>
          </a> 
        </li>  
        <li class="nav-item menu-open">
          <a href="demandeur.html" class="nav-link active">
            <i class="nav-icon fas fa-users"></i>
            <p>
              Demandeur  D'emploi
            </p>
          </a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon fas fa-building"></i>
            <p>
              Recruteur
              <i class="fas fa-angle-left right"></i>
              <span class="badge badge-info right">2</span>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a href="recruteurEnAttente.html" class="nav-link">
                <i class="far fa-circle nav-icon"></i>
                <p>Recruteur en attente</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="recruteurconfirmer.html" class="nav-link">
                <i class="far fa-circle nav-icon"></i>
                <p>Recruteur confirmer</p>
              </a>
            </li>
          </ul>
        </li>
        <li class="nav-item">
          <a href="reclamation.html" class="nav-link">
            <i class="nav-icon fas fa-copy"></i>
            <p>
              Réclamation
            </p>
          </a>
        </li>
        <li class="nav-item">
          <a href="offre.html" class="nav-link">
            <i class="nav-icon fas fa-briefcase"></i>
            <p>
              Offre
            </p>
          </a>
        </li>
        <li class="nav-item ">
          <a href="contacts.html" class="nav-link">
            <i class="nav-icon fas fa-comments"></i>
            <p>
              Contacts
            </p>
          </a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon fas fa-user"></i>
            <p>
              Gestionnaire
              <i class="fas fa-angle-left right"></i>
              <span class="badge badge-info right">2</span>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a href="formajoutadmin.html" class="nav-link">
                <i class="far fa-circle nav-icon"></i>
                <p>Ajouter</p>
              </a>
            </li>
            <li class="nav-item">
              <a href="listadmin.html" class="nav-link">
                <i class="far fa-circle nav-icon"></i>
                <p>Lister</p>
              </a>
            </li>
          </ul>
        </li>
          <div class="user-panel mt-3 pb-3 mb-3 d-flex">
          </div>
        <li class="nav-item">
          <a href="#" onclick="quitter()" class="nav-link">
            <i class="nav-icon fas fa-lock"></i>
            <p>
              Deconexion 
            </p>
          </a>
        </li>
      </ul>
    </nav>
    <!-- /.sidebar-menu -->
  </div>
  <!-- /.sidebar -->
</aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1>Profile Demandeur D'emploi Archivé</h1>
          </div>
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="../index.html">Accueil</a></li>
              <li class="breadcrumb-item active"><a href="demandeurArch.html">Demandeur D'emploi Archivé</a></li>
            </ol>
          </div>
        </div>
      </div><!-- /.container-fluid -->
    </section>
    
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-10">
                <div class="card">
                <div class="row">
                    <div class="col-md-3 ">
              <!-- Profile Image -->
                        <div class="card-body "> 
                            <div class="text-center">
                                <img id="photoDEM" class="profile-user-img img-fluid img-circle" src="" style="width:100px; height: 100px;" alt="User profile picture">
                            </div>
            
                            <h3 id="nompreDEM" class="profile-username text-center"></h3>
            
                            <ul class="list-group list-group-unbordered mb-3">
                                <li class="list-group-item">
                                    <i class="fas fa-address-book"></i>&ensp;&ensp;<b>Contact</b> 
                                    <br>&ensp;&ensp;&ensp;<i class="fas fa-map-marked-alt"></i>&ensp;&ensp;<span id="paysvilleDEM"></span>

                                    <br>&ensp;&ensp;&ensp;<i class="fas fa-map-marker-alt"></i>&ensp;&ensp;<span id="adressecopDEM"></span> 

                                    <br>&ensp;&ensp;&ensp;<i class="fas fa-phone-alt"></i>&ensp;&ensp;<span id="numtelDEM"></span> 

                                    <br>&ensp;&ensp;&ensp;<i class="fas fa-envelope"></i>&ensp;&ensp; <a id="emailDEM" href="https://mail.google.com/" class="btn-link text-secondary"></a>

                                    <br>&ensp;&ensp;&ensp;<i class="fab fa-linkedin"></i>&ensp;&ensp; <a id="urllinkDEM" href="" class="btn-link text-secondary"></a>

                                    <br>&ensp;&ensp;&ensp;<i class="fab fa-facebook"></i>&ensp;&ensp; <a id="urlfbDEM" href="" class="btn-link text-secondary"></a>
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-calendar-alt"></i>&ensp;&ensp;<b>Date de naissance</b>
                                    <ul>
                                        <li id="datnaisDEM"></li>
                                    </ul> 
                                </li>
                                <li class="list-group-item">
                                    <i class="fas fa-car"></i>&ensp;&ensp;<b>Permis de conduire</b>
                                    <ul>
                                        <li id="listpermis"> <span id="permisDEM">  </li>
                                    </ul> 
                                </li>
                            </li>
                            <li class="list-group-item">
                                <i class="fas fa-medal"></i>&ensp;&ensp;<b>Qualité</b>
                                <ul id="qualiteDEM">
                                </ul> 
                            </li>
                            <li class="list-group-item">
                                <i class="fas fa-book "></i>&ensp;&ensp; <b>Langues</b>
                                <ul id="listlangueDEM">
                                </ul>
                            </li>
                            <li class="list-group-item">
                                <i class="fas fa-star"></i>&ensp;&ensp; <b>Centres D'intérêts</b>
                                <ul id="centreintDEM">
                                </ul>
                            </li>
                            <li class="list-group-item">
                              <i class="fas fa-calendar-alt"></i>&ensp;&ensp; <b>Date de création</b>
                              <ul>
                                <li id="datecreaDEM"></li>
                            </ul> 
                          </li>
                          <li class="list-group-item">
                            <i class="fas fa-calendar-alt"></i>&ensp;&ensp; <b>Date mise à jour</b>
                            <ul>
                              <li id="datemsjDEM"></li>
                          </ul> 
                        </li>
                            </ul>
                        <!-- /.card -->
                        </div>
                        <!-- /.card-body -->
                    </div>
                    <!-- /.col -->
                    <div class="col-md-9">
                      <blockquote>
                        <div class="card-body">
                            <div class="tab-content">
                                <div class="active tab-pane">
                                <i class="fas fa-user"></i>&ensp;&ensp;<b>Profile</b>
                                <ul class="list-group list-group-unbordered mb-3">
                                    
                                    <li id="listprofil" class="list-group-item"> 
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-award"></i>&ensp;&ensp;<b>Expérience Professionnelle</b> </li>
                                    <li id="listEXP" class="list-group-item">
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-user-graduate"></i>&ensp;&ensp;<b>Diplôme</b> </li>
                                    <li id="listDIP" class="list-group-item">
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-graduation-cap"></i>&ensp;&ensp;<b>Formation</b> </li>
                                    <li id="listFOR" class="list-group-item">
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-certificate"></i>&ensp;&ensp;<b>Certifications</b></li>
                                    <li id="listCERT" class="list-group-item"> 
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-trophy"></i>&ensp;&ensp;<b>Projets</b></li>
                                    <li id="listPROJ" class="list-group-item">
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-puzzle-piece"></i>&ensp;&ensp;<b>Vie Associative</b></li>
                                    <li id="listVA" class="list-group-item"> 
                                    </li>
                                    <li class="list-group-item"><i class="fas fa-tasks"></i>&ensp;&ensp;<b>Compétences</b></li>
                                    <li id="pasCOMP" class="list-group-item"> 
                                        <div class="row">
                                            
                                            <div class="col-sm-4">
                                                <ul id="listCOMP1">
                                                </ul>
                                            </div>
                                            <div class="col-sm-2"></div>
                                            <div class="col-sm-4">
                                                <ul id="listCOMP2">
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                </ul> 
                                <form>
                                    <div class="card-body ">
                                      
                                      <a class="btn btn-secondary  float-right" href="#" onClick="updateDem()"  style="margin-right: 5px;">
                                        <i class="fas fa-undo-alt"></i>    
                                      </a>
                                      <a class="btn btn-primary float-right " href="demandeurArch.html" style="margin-right: 5px;" >
                                        <i class="fas fa-less-than"></i>
                                      </a> 
                                    </div>
                                </form>
                                </div>
                                <!-- /.tab-pane -->  
                            </div>
                            <!-- /.tab-content -->
                        </div>
                        <!-- /.card-body -->
                      </blockquote>
                    </div>
                    <!-- /.col -->
                </div>
                <!-- /.row -->
                </div>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
    </section>
    <!-- /.content -->

    <a id="back-to-top" href="#" class="btn btn-primary back-to-top" role="button" aria-label="Scroll to top">
      <i class="fas fa-chevron-up"></i>
    </a>
  </div>
  <!-- /.content-wrapper -->

  <footer class="main-footer">

    <strong>&copy; 2021-2022 <a href="../index.html">Recrute</a>.</strong>
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->
<!--alert-->
<script src="https://unpKg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<!-- jQuery -->
<script src="../plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- AdminLTE App -->

<script src="../plugins/datatables/jquery.dataTables.min.js"></script>
<script src="../plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="../plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="../plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<script src="../plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
<script src="../plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
<script src="../plugins/jszip/jszip.min.js"></script>
<script src="../plugins/pdfmake/pdfmake.min.js"></script>
<script src="../plugins/pdfmake/vfs_fonts.js"></script>
<script src="../plugins/datatables-buttons/js/buttons.html5.min.js"></script>
<script src="../plugins/datatables-buttons/js/buttons.print.min.js"></script>
<script src="../plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
<script src="../dist/js/adminlte.min.js"></script>
<!--mail-->
<script src="https://smtpjs.com/v3/smtp.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="../dist/js/demo.js"></script>
<script src="../dist/js/notific.js"></script>

<script>
  var liste =["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"];
  var url_string = window.location.href ;
  var url = new URL(url_string); 
  var c = url.searchParams.get("id"); 
    console.log(c);
    // Post a user
    var url3 = "http://192.168.43.96:3000/demandeurs/" + c ;
    var xhr3 = new XMLHttpRequest();
    xhr3.open("GET", url3, true);

    xhr3.onload = function () {
      var data = JSON.parse(xhr3.responseText);
      if (xhr3.readyState == 4 && xhr3.status == "200") {
          document.getElementById("photoDEM").src = data.PHOTO_DEM;
          document.getElementById("nompreDEM").innerHTML = data.NOM_DEM + ' '+ data.PRE_DEM;
          document.getElementById("paysvilleDEM").innerHTML = data.PAYS_DEM + ', '+ data.VILLE_DEM;
          document.getElementById("adressecopDEM").innerHTML = data.ADRESSE_DEM + ', '+ data.COD_POST_DEM;
          document.getElementById("numtelDEM").innerHTML = data.NUM_TEL_DEM;
          document.getElementById("emailDEM").innerHTML = data.EMAIL_DEM;
          document.getElementById("urllinkDEM").innerHTML = data.NOM_DEM + '-'+ data.PRE_DEM;
          document.getElementById("urlfbDEM").innerHTML = data.NOM_DEM + ' '+ data.PRE_DEM;
          document.getElementById("urllinkDEM").href = data.URL_LINK_DEM;
          document.getElementById("urlfbDEM").href = data.URL_FB_DEM;
          document.getElementById("datnaisDEM").innerHTML = data.DAT_NAI_DEM;
          document.getElementById("listprofil").innerHTML = data.DESC_DEM;
          if (data.PERMIS_COND_DEM == "1"){
                    ch=`<span id="permisDEM">Permis:</span> <span id="typepermisDEM">`+data.TYPE_PERMIS_DEM+`</span> `;
                    document.getElementById("listpermis").innerHTML = ch;
                  }else{
                    document.getElementById("listpermis").innerHTML = 'Pas de permis';
                  }
          var request1 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request1.open('GET', "http://192.168.43.96:3000/qualites", true);
              request1.onload = function()
              {
                // Begin accessing JSON data here
                var data1 = JSON.parse(this.response);
                console.log(data1);
                var ee = document.getElementById("qualiteDEM");
                var nb=0;
                data1.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                      ch ="<li><span >"+j.NOM_QUA+"</li>";
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb +=1;
                  }
                })
                if (nb == 0){
                    var lii = document.createElement("li");
                    lii.innerText = "Pas de qualité";
                    document.getElementById('qualiteDEM').appendChild(lii);
                }
              }
              // Send request
          request1.send();
          var request2 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request2.open('GET', "http://192.168.43.96:3000/languedemandeurs", true);
              request2.onload = function()
              {
                // Begin accessing JSON data here
                var data2 = JSON.parse(this.response);
                console.log(data2);
                var ee = document.getElementById("listlangueDEM");
                var nb=0;
                data2.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                      var request3 = new XMLHttpRequest();
                      request3.open('GET', "http://192.168.43.96:3000/langues/"+j.ID_LANGUE, true);
                      request3.onload = function()
                      {
                        var data3 = JSON.parse(this.response);
                        var num=j.NIV_LANG_DEM;
                        if(num==="1"){ 
                                  ch = `<li><span >`+data3.NOM_LANG+`</span>  :
                                            <span class="fas fa-star checked1" id="star11"></span>
                                            <span class="far fa-star checked1" id="star22"></span>
                                            <span class="far fa-star checked1" id="star33"></span>
                                            <span class="far fa-star checked1" id="star44"></span>
                                            <span class="far fa-star checked1" id="star55"></span>
                                        </li>    

                                  `;
                                  ee.insertAdjacentHTML('beforeend',ch);
                          }
                        if(num=="2"){
                          ch = `<li><span >`+data3.NOM_LANG+`</span>  :
                                  <span class="fas fa-star checked1" id="star11"></span>
                                  <span class="fas fa-star checked1" id="star22"></span>
                                  <span class="far fa-star checked1" id="star33"></span>
                                  <span class="far fa-star checked1" id="star44"></span>
                                  <span class="far fa-star checked1" id="star55"></span>
                                </li>
                                  `;
                                  ee.insertAdjacentHTML('beforeend',ch);
                        }
                        if(num=="3"){
                          ch = `<li><span >`+data3.NOM_LANG+`</span>  :
                                  <span class="fas fa-star checked1" id="star11"></span>
                                  <span class="fas fa-star checked1" id="star22"></span>
                                  <span class="fas fa-star checked1" id="star33"></span>
                                  <span class="far fa-star checked1" id="star44"></span>
                                  <span class="far fa-star checked1" id="star55"></span>
                                </li>
                                  `;
                                  ee.insertAdjacentHTML('beforeend',ch);
                        }
                        if(num=="4"){
                          ch = `<li><span >`+data3.NOM_LANG+`</span>  :
                                  <span class="fas fa-star checked1 " id="star11"></span>
                                  <span class="fas fa-star checked1  " id="star22"></span>
                                  <span class="fas fa-star checked1  " id="star33"></span>
                                  <span class="fas fa-star checked1 " id="star44"></span>
                                  <span class="far fa-star checked1" id="star55"></span>
                                </li>
                                  `;
                                  ee.insertAdjacentHTML('beforeend',ch);
                        }
                        if(num=="5"){
                          ch = `  <li><span >`+data3.NOM_LANG+`</span>  :
                                    <span class="fas fa-star checked1 " id="star11"></span>
                                    <span class="fas fa-star checked1 " id="star22"></span>
                                    <span class="fas fa-star checked1 " id="star33"></span>
                                    <span class="fas fa-star checked1 " id="star44"></span>
                                    <span class="fas fa-star checked1 " id="star55"></span>
                                  </li>
                                  `;
                                  ee.insertAdjacentHTML('beforeend',ch); 

                        }

                       // ch ="<li><span >"+data3.NOM_LANG+"</span>  :  <span >"+j.NIV_LANG_DEM+"</span></li>";
                       // ee.insertAdjacentHTML('beforeend',ch);    
                      }
                      request3.send();
                      nb +=1;
                  }
                })
                if (nb == 0){
                    var lii = document.createElement("li");
                    lii.innerText = "Pas de langue";
                    document.getElementById('listlangueDEM').appendChild(lii);
                }
          }
          request2.send();
          var request4 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request4.open('GET', "http://192.168.43.96:3000/centresinterets", true);
              request4.onload = function()
              {
                // Begin accessing JSON data here
                var data4 = JSON.parse(this.response);
                console.log(data4);
                var nb=0;
                var ee = document.getElementById("centreintDEM");
                data4.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                      ch ="<li><span >"+j.NOM_CI+"</li>";
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb +=1;
                  }
                })
                if (nb == 0){
                    var lii = document.createElement("li");
                    lii.innerText = "Pas de centre d'interet";
                    document.getElementById('centreintDEM').appendChild(lii);
                }
              }
              // Send request
          request4.send();
          var dateCrea = data.createdAt.split('T');
          var dateMSJ = data.updatedAt.split('T');
          document.getElementById("datecreaDEM").innerHTML = dateCrea[0];
          document.getElementById("datemsjDEM").innerHTML = dateMSJ[0];
          var request5 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request5.open('GET', "http://192.168.43.96:3000/experiences", true);
              request5.onload = function()
              {
                // Begin accessing JSON data here
                var data5 = JSON.parse(this.response);
                console.log(data5);
                var ee = document.getElementById("listEXP");
                var nb=0;
                data5.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                    var tabDEB = j.DAT_DEB_EXP.split('-');
                    var tabFIN = j.DAT_FIN_EXP.split('-');
                    if(tabDEB[1]<10){
                      tabDEB[1]=tabDEB[1][1];
                    }
                    if(tabFIN[1]<10){
                      tabFIN[1]=tabFIN[1][1];
                    }
                      ch = `<p ><b><i>`+j.TYPE_EXP+`</i></b></p>    
                                    <p >`+j.NOM_ENT_EXP+`  |  `+liste[tabDEB[1]-1]+` `+tabDEB[0]+ ` - `+liste[tabFIN[1]-1]+` `+tabFIN[0]+`</p>
                                    <p >`+j.POSITION_EXP+`</p>
                                    <p >`+j.DESC_EXP+`</p>
                                    <p >`+j.OUTIL_EXP+`</p> `;
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb+=1;
                  }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas d'experience";
                    document.getElementById('listEXP').appendChild(pp);
                }
              }
              // Send request
          request5.send();
          var request6 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request6.open('GET', "http://192.168.43.96:3000/formations", true);
              request6.onload = function()
              {
                // Begin accessing JSON data here
                var data6 = JSON.parse(this.response);
                console.log(data6);
                var ee = document.getElementById("listFOR");
                var nb=0;
                data6.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                    var tabDEB = j.DAT_DEB_FOR.split('-');
                    var tabFIN = j.DAT_FIN_FOR.split('-');
                    if(tabDEB[1]<10){
                      tabDEB[1]=tabDEB[1][1];
                    }
                    if(tabFIN[1]<10){
                      tabFIN[1]=tabFIN[1][1];
                    }
                      ch = `<p ><b><i>`+j.NOM_FOR+`</i></b></p>    
                                    <p >`+liste[tabDEB[1]-1]+` `+tabDEB[0]+` - `+liste[tabFIN[1]-1]+` `+tabFIN[0]+`</p>
                                    <p >`+j.DESC_FOR+`</p> `;
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb+=1;
                  }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas de formation";
                    document.getElementById('listFOR').appendChild(pp);
                }
              }
              // Send request
          request6.send();
          var request7 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request7.open('GET', "http://192.168.43.96:3000/certifications", true);
              request7.onload = function()
              {
                // Begin accessing JSON data here
                var data7 = JSON.parse(this.response);
                console.log(data7);
                var ee = document.getElementById("listCERT");
                var nb=0;
                data7.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                      ch = `<p ><b><i>`+j.NOM_CERT+`</i></b></p>    
                                    <p >`+j.REF_CERT+`</p>
                                    <p >`+j.DESC_CERT+`</p> `;
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb+=1;
                  }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas de certificat";
                    document.getElementById('listCERT').appendChild(pp);
                }
              }
              // Send request
          request7.send();
          var request8 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request8.open('GET', "http://192.168.43.96:3000/projets", true);
              request8.onload = function()
              {
                // Begin accessing JSON data here
                var data8 = JSON.parse(this.response);
                console.log(data8);
                var ee = document.getElementById("listPROJ");
                var nb=0;
                data8.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                    var tabDEB = j.DAT_DEB_PROJ.split('-');
                    var tabFIN = j.DAT_FIN_PROJ.split('-');
                    if(tabDEB[1]<10){
                      tabDEB[1]=tabDEB[1][1];
                    }
                    if(tabFIN[1]<10){
                      tabFIN[1]=tabFIN[1][1];
                    }
                      ch = `<p ><b><i>`+j.NOM_PROJ+`</i></b></p> 
                                    <p >`+j.TYPE_PROJ+`</p>   
                                    <p >`+liste[tabDEB[1]-1]+` `+tabDEB[0]+` - `+liste[tabFIN[1]-1]+` `+tabFIN[0]+`</p>
                                    <p >`+j.DESC_PROJ+`</p>
                                    <p >`+j.OUTIL_PROJ+`</p> `;
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb+=1;
                  }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas de projet";
                    document.getElementById('listPROJ').appendChild(pp);
                }
              }
              // Send request
          request8.send();
          var request9 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request9.open('GET', "http://192.168.43.96:3000/vieassociatives", true);
              request9.onload = function()
              {
                // Begin accessing JSON data here
                var data9 = JSON.parse(this.response);
                console.log(data9);
                var ee = document.getElementById("listVA");
                var nb=0;
                data9.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                    var tabDEB = j.DAT_DEB_VA.split('-');
                    var tabFIN = j.DAT_FIN_VA.split('-');
                    if(tabDEB[1]<10){
                      tabDEB[1]=tabDEB[1][1];
                    }
                    if(tabFIN[1]<10){
                      tabFIN[1]=tabFIN[1][1];
                    }
                      ch = `<p ><b><i>`+j.NOM_VA+`</i></b></p>  
                                <p >`+j.POSITION_VA+`  |  `+liste[tabDEB[1]-1]+` `+tabDEB[0]+` - `+liste[tabFIN[1]-1]+` `+tabFIN[0]+`</p>`;
                      ee.insertAdjacentHTML('beforeend',ch);
                      nb+=1;
                    }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas de vie associative";
                    document.getElementById('listVA').appendChild(pp);
                }
              }
              // Send request
          request9.send();
          var request10 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request10.open('GET', "http://192.168.43.96:3000/competencedemandeurs", true);
              request10.onload = function()
              {
                // Begin accessing JSON data here
                var data10 = JSON.parse(this.response);
                console.log(data10);
                var ee1 = document.getElementById("listCOMP1");
                var nbee1=0;
                var ee2 = document.getElementById("listCOMP2");
                var nbee2=0;
                var nb=0;
                data10.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                      var request11 = new XMLHttpRequest();
                      request11.open('GET', "http://192.168.43.96:3000/competences/"+j.ID_COMPETENCE, true);
                      request11.onload = function()
                      {
                        var data11 = JSON.parse(this.response);
                       // ch ="<li><span >"+data11.NOM_COMP+"</span>  :  <span >"+j.NIV_COMP_DEM+"</span></li>";
                       var num=j.NIV_COMP_DEM;
                        if(num==="1"){ 
                                  ch = `<li><span >`+data11.NOM_COMP+`</span>  :
                                            <span class="fas fa-star checked1" id="star11"></span>
                                            <span class="far fa-star checked1" id="star22"></span>
                                            <span class="far fa-star checked1" id="star33"></span>
                                            <span class="far fa-star checked1" id="star44"></span>
                                            <span class="far fa-star checked1" id="star55"></span>
                                        </li>    

                                  `;
                                  
                          }
                        if(num=="2"){
                          ch = `<li><span >`+data11.NOM_COMP+`</span>  :
                                  <span class="fas fa-star checked1" id="star11"></span>
                                  <span class="fas fa-star checked1" id="star22"></span>
                                  <span class="far fa-star checked1" id="star33"></span>
                                  <span class="far fa-star checked1" id="star44"></span>
                                  <span class="far fa-star checked1" id="star55"></span>
                                </li>
                                  `;
                                  
                        }
                        if(num=="3"){
                          ch = `<li><span >`+data11.NOM_COMP+`</span>  :
                                  <span class="fas fa-star checked1" id="star11"></span>
                                  <span class="fas fa-star checked1" id="star22"></span>
                                  <span class="fas fa-star checked1" id="star33"></span>
                                  <span class="far fa-star checked1" id="star44"></span>
                                  <span class="far fa-star checked1" id="star55"></span>
                                </li>
                                  `;
                                  
                        }
                        if(num=="4"){
                          ch = `<li><span >`+data11.NOM_COMP+`</span>  :
                                  <span class="fas fa-star checked1 " id="star11"></span>
                                  <span class="fas fa-star checked1  " id="star22"></span>
                                  <span class="fas fa-star checked1  " id="star33"></span>
                                  <span class="fas fa-star checked1 " id="star44"></span>
                                  <span class="far fa-star checked1" id="star55"></span>
                                </li>
                                  `;
                                  
                        }
                        if(num=="5"){
                          ch = `  <li><span >`+data11.NOM_COMP+`</span>  :
                                    <span class="fas fa-star checked1 " id="star11"></span>
                                    <span class="fas fa-star checked1 " id="star22"></span>
                                    <span class="fas fa-star checked1 " id="star33"></span>
                                    <span class="fas fa-star checked1 " id="star44"></span>
                                    <span class="fas fa-star checked1 " id="star55"></span>
                                  </li>
                                  `;
                                  

                        }


                        if(nbee1>nbee2){
                          ee2.insertAdjacentHTML('beforeend',ch);
                          nbee2 +=1;
                        }else if (nbee1==nbee2){
                          ee1.insertAdjacentHTML('beforeend',ch); 
                          nbee1 +=1;
                        }else {
                          ee1.insertAdjacentHTML('beforeend',ch); 
                          nbee1 +=1;
                        }   
                      }
                      request11.send();
                      nb +=1;
                  }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas de compétence";
                    document.getElementById('pasCOMP').appendChild(pp);
                }
          }
          request10.send();
          var request12 = new XMLHttpRequest();
              // Open a new connection, using the GET request on the URL endpoint
              request12.open('GET', "http://192.168.43.96:3000/diplomedemandeurs", true);
              request12.onload = function()
              {
                // Begin accessing JSON data here
                var data12 = JSON.parse(this.response);
                console.log(data12);
                var ee = document.getElementById("listDIP");
                var nb=0;
                data12.forEach(j => {
                  if(j.ID_DEMANDEUR==c){
                    var tabDEB = j.DAT_DEB_DIP.split('-');
                    var tabFIN = j.DAT_FIN_DIP.split('-');
                    if(tabDEB[1]<10){
                      tabDEB[1]=tabDEB[1][1];
                    }
                    if(tabFIN[1]<10){
                      tabFIN[1]=tabFIN[1][1];
                    }
                      var request13 = new XMLHttpRequest();
                      request13.open('GET', "http://192.168.43.96:3000/diplomes/"+j.ID_DIPLOME, true);
                      request13.onload = function()
                      {
                        var data13 = JSON.parse(this.response);
                        ch = `<p ><b><i>`+data13.TYPE_DIP+`</i></b></p>    
                                    <p >`+j.NOM_ECOL_DIP+`  |  `+liste[tabDEB[1]-1]+` `+tabDEB[0]+` - `+liste[tabFIN[1]-1]+` `+tabFIN[0]+`</p>
                                    <p >`+j.SPECIA_DIP+`</p> `;
                        ee.insertAdjacentHTML('beforeend',ch);  
                      }
                      request13.send();
                      nb +=1;
                  }
                })
                if (nb == 0){
                    var pp = document.createElement("p");
                    pp.innerText = "Pas de diplôme";
                    document.getElementById('listDIP').appendChild(pp);
                }
          }
          request12.send();
      } else {
          console.log("error");
      }
    }
    xhr3.send(null);
/*
    function delatedem(){ 
    
      Swal.fire({
          title: 'Etes vous Sure?',
          text: "Vous souhaitez le supprimer !",
          icon: 'warning',
          showCancelButton: true,
          confirmButtonColor: '#228B22',
          cancelButtonColor: '#d33',
          confirmButtonText: 'Oui, Supprimer!'
        }).then((result) => {
          if (result.isConfirmed) {
        var url_string = window.location.href
        var url = new URL(url_string);
        var c = url.searchParams.get("id");
        // Post a user
        var url3 = "http://192.168.43.96:3000/demandeurs/" + c ;
        var xhr3 = new XMLHttpRequest();
        xhr3.open("DELETE", url3, true);
        xhr3.onload = function () {
          if (xhr3.readyState == 4 && xhr3.status == "200") {
                  Swal.fire({
                      title:'Supprimer!',
                      text:'Ce fichier est supprimer avec succés.',
                      icon:'success',
                    
                  }).then((result) => {
                      if (result.isConfirmed){
                        location.replace("demandeur.html");
                         event.preventDefault();
                      }

                  })
                
                } 
              }  
              xhr3.send(null);
        
          }
        })            
    }
*/
    function updateDem(){
          Swal.fire({
          title: "Voulez-vous désarchiver cette Demandeur ?",
          icon: 'question',
          showDenyButton: true,
          confirmButtonColor: '#17a2b8',
          confirmButtonText: 'Désarchiver',
          denyButtonText: `Non`,
        }).then((result) => {
          if (result.isConfirmed) {
            var url_string = window.location.href
            var url = new URL(url_string);
            var c = url.searchParams.get("id");
            var request = new XMLHttpRequest()
            
            // Open a new connection, using the GET request on the URL endpoint
            request.open('GET', 'http://192.168.43.96:3000/demandeurs/'+ c, true)
            
            request.onload = function() {
                // Begin accessing JSON data here
                var data = JSON.parse(this.response)
                console.log(data);
                var url3 = "http://192.168.43.96:3000/demandeurs/" + c ;
                data2={};
                data2.PHOTO_DEM = data.PHOTO_DEM;
                data2.EMAIL_DEM = data.EMAIL_DEM;
                data2.PSW_DEM = data.PSW_DEM;
                data2.NOM_DEM = data.NOM_DEM;
                data2.PRE_DEM = data.PRE_DEM;
                data2.SEXE_DEM = data.SEXE_DEM;
                data2.DAT_NAI_DEM = data.DAT_NAI_DEM;
                data2.VILLE_DEM = data.VILLE_DEM;
                data2.PAYS_DEM = data.PAYS_DEM;
                data2.ADRESSE_DEM = data.ADRESSE_DEM;
                data2.NUM_TEL_DEM = data.NUM_TEL_DEM;
                data2.COD_POST_DEM = data.COD_POST_DEM;
                data2.PERMIS_COND_DEM = data.PERMIS_COND_DEM;
                data2.TYPE_PERMIS_DEM = data.TYPE_PERMIS_DEM;
                data2.SAL_MIN_DEM = data.SAL_MIN_DEM;
                data2.URL_LINK_DEM = data.URL_LINK_DEM;
                data2.DESC_DEM = data.DESC_DEM;
                data2.SPES_DEM = data.SPES_DEM;
                data2.ARCHIV_DEM = "0";
                data2.URL_FB_DEM = data.URL_FB_DEM;
                Email.send({
                      Host: "smtp.gmail.com",
                      Username : "tunisierecrute0@gmail.com",
                      Password : "Recrute123",
                      To : `${data.EMAIL_DEM}`,
                      From : "tunisierecrute0@gmail.com",
                      Subject : "désarchivation de compte",
                      Body : "Votre compte est désarchivé. ",
                    })  
                console.log(data2);
                var json = JSON.stringify(data2);
                var xhr3 = new XMLHttpRequest();
                xhr3.open("PUT", url3, true);
                xhr3.setRequestHeader('Content-type','application/json; charset=utf-8');
                xhr3.onload = function () {
                    if (xhr3.readyState == 4 && xhr3.status == "200") {
                        //location.replace("archiveAdmin.html");
                        //event.preventDefault();
                        Swal.fire({
                            title:'Compte Demandeur Est Désarchivé !',
                            icon:'success',
                        
                        }).then((result) => {
                            if (result.isConfirmed){
                            location.replace("demandeurARCH.html");
                            event.preventDefault();
                            }

                        })
                    } else {
                        console.log("error");
                        Swal.fire({
                                    icon:'error',  
                                    title:'Il y a un erreur !',
                                    showConfirmButton:true,
                                    timer:1500
                                        
                                    
                                    })
                    }
                }
                xhr3.send(json);
            }
            request.send();
        }
        else if (result.isDenied){
           Swal.fire("Désarchive Non Enregistrer", '', 'info');
        }
      })
    }
              
</script>

</body>
</html>
